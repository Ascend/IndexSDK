cmake_minimum_required(VERSION 3.14.1)

project(ock_hcps_pier CXX)

include(${CMAKE_CURRENT_LIST_DIR}/cmake/tool_chain.cmake)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/algo PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/hfo PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/modelpath PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/handler PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/dist_int8_cos_max_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/dist_mask_gen_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/dist_mask_with_extra_gen_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/l2_norm_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/topk_flat_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/trans_data_shaped_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/trans_data_custom_attr_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/remove_data_custom_attr_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/remove_data_shaped_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/nop/remove_data_attr_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/hcop/topk_dist_comp_op PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/hcps/stream PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/vsa/neighbor/npu PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/vsa/neighbor/npu/impl PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/vsa/neighbor/base PIER_SRC)
aux_source_directory(${CMAKE_CURRENT_LIST_DIR}/utils PIER_SRC)

add_library(ock_hcps_pier SHARED ${PIER_SRC})

target_link_libraries(ock_hcps_pier PUBLIC ock_hmm ascendcl c_sec pthread)
file(MAKE_DIRECTORY ${OUTPUT_PATH}/hcps_pier)
set(TARGET_INSTALL_LIB ${OUTPUT_PATH}/hcps_pier/lib)
set_target_properties(ock_hcps_pier PROPERTIES VERSION 23.0.0 SOVERSION 1)
install(TARGETS ock_hcps_pier DESTINATION ${TARGET_INSTALL_LIB}/ PERMISSIONS OWNER_WRITE OWNER_READ OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)